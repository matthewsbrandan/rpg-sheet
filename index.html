<!DOCTYPE html>
<html lang="pt-BR" class="bg-slate-900">
<head class="m-0 p-0">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RPG</title>
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
</head>
<body class="m-0 p-0 w-screen h-screen overflow-y-auto">
  <main class="text-gray-400 py-4 px-6 m-0" id="app">
    <div class="fixed right-4 bg-slate-900 px-2.5 pt-1 pb-1.5  border-2 border-emerald-500 text-emerald-500 text-xs rounded-xl" v-if="game.is_auto_saved">Salvo Automaticamente</div>
    <header class="grid grid-cols-3 gap-x-6">
      <div class="mt-2">
        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="text" v-model="bio.nome" id="nome" autocomplete="nome" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6" placeholder="Nome">
        </div>
      </div>
      <div class="mt-2">
        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="text" v-model="bio.ocupacao" id="ocupacao" autocomplete="ocupacao" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6" placeholder="Ocupação">
        </div>
      </div>
      <div class="mt-2">
        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="text" v-model="bio.origem" id="origem" autocomplete="origem" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6" placeholder="Origem">
        </div>
      </div>
    </header>
    <div class="grid grid-cols-3 gap-x-6 mt-6">
      <div class="grid grid-cols-3 gap-x-6 gap-y-2" id="attributes">
        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="number" v-model="atributos.forca" id="forca" autocomplete="forca" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6">
        </div>
        FOR
        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="number" v-model="atributos.modificador_forca" id="modificador-forca" autocomplete="modificador-forca" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6">
        </div>

        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="number" v-model="atributos.agilidade" id="agilidade" autocomplete="agilidade" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6">
        </div>
        AGI
        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="number" v-model="atributos.modificador_agilidade" id="modificador-agilidade" autocomplete="modificador-agilidade" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6">
        </div>

        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="number" v-model="atributos.saude" id="saude" autocomplete="saude" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6">
        </div>
        SAÚ
        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="number" v-model="atributos.modificador_saude" id="modificador-saude" autocomplete="modificador-saude" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6">
        </div>
        
        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="number" v-model="atributos.inteligencia" id="inteligencia" autocomplete="inteligencia" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6">
        </div>
        INT
        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="number" v-model="atributos.modificador_inteligencia" id="modificador-inteligencia" autocomplete="modificador-inteligencia" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6">
        </div>

        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="number" v-model="atributos.sabedoria" id="sabedoria" autocomplete="sabedoria" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6">
        </div>
        SAB
        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="number" v-model="atributos.modificador_sabedoria" id="modificador-sabedoria" autocomplete="modificador-sabedoria" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6">
        </div>

        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="number" v-model="atributos.personalidade" id="personalidade" autocomplete="personalidade" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6">
        </div>
        PER
        <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
          <input type="number" v-model="atributos.modificador_personalidade" id="modificador-personalidade" autocomplete="modificador-personalidade" class="block flex-1 border-0 bg-transparent py-1.5 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6">
        </div>
      </div>

      <div class="col-span-2 grid grid-cols-2 gap-x-2 gap-y-2">
        <div class="bg-slate-800 px-2 py-1 flex flex-col">
          <span class="text-sm font-semibold">Defesa</span>
          <textarea v-model="atributos.defesa" id="defesa" name="defesa" class="flex-1 w-full  !border-0 py-1.5 sm:text-sm sm:leading-6 bg-transparent p-0 !outline-0 !ring-0"></textarea>
        </div>
        <div class="bg-slate-800 px-2 py-1 flex flex-col">
          <span class="text-sm font-semibold">Pontos de vida</span>
          <textarea v-model="atributos.vida" id="vida" name="vida" class="flex-1 w-full  !border-0 py-1.5 sm:text-sm sm:leading-6 bg-transparent p-0 !outline-0 !ring-0"></textarea>
        </div>
        <div class="bg-slate-800 col-span-2 min-h-[4rem]">
          <button type="button" class="bg-slate-700 px-2 py-1 w-full text-left text-sm font-semibold" v-on:click="openModal('abilities')">Habilidades</button>
          <div class="grid grid-cols-2 gap-2 px-2 py-1 max-h-[8rem] overflow-y-auto" v-if="!!atributos.habilidades">
            <span class="border-b border-slate-700/40" v-for="habilidade in atributos.habilidades" :key="habilidade">{{ habilidade }}</span>
          </div>
        </div>
      </div>
    </div>
    <div class="grid grid-cols-3 gap-x-2 mt-6 w-full">
      <div class="col-span-2 bg-slate-800 min-h-[4rem]">
        <button type="button" class="bg-slate-700 px-2 py-1 w-full text-left text-sm font-semibold" v-on:click="openModal('equipaments')">Equipamentos</button>
        <div class="grid grid-cols-2 gap-2 px-2 py-1 max-h-[16rem] overflow-y-auto" v-if="!!itens.equipamentos">
          <span class="border-b border-slate-700/40" v-for="equipamento in itens.equipamentos" :key="equipamento">{{ equipamento }}</span>
        </div>
      </div>
      <div class="flex flex-col flex-1 gap-y-2">
        <div class="bg-slate-800 min-h-[3rem]">
          <button type="button" class="bg-slate-700 px-2 pt-1 w-full text-left text-sm font-semibold" v-on:click="openModal('arms')">Armas e Armaduras</button>
          <div class="flex flex-col gap-1 max-h-[8rem] overflow-y-auto" v-if="!!itens.armas">
            <span class="flex justify-between border-b last:border-0 border-slate-700/40" v-for="arma in itens.armas" :key="arma">
              <span class="px-2 py-1 flex-1">{{ arma.name }}</span>
              <span class="bg-slate-700/40 px-2 py-1">{{ arma.value }}</span>
            </span>
          </div>
        </div>
        <div class="bg-slate-800 min-h-[4rem] px-2 py-1">
          <span class="text-sm font-semibold">Tesouros</span>
          <textarea v-model="itens.tesouros[0]" class="flex-1 w-full  !border-0 py-1.5 sm:text-sm sm:leading-6 bg-transparent p-0 !outline-0 !ring-0"></textarea>
        </div>
      </div>
    </div>

    <div class="mt-6 mb-6 flex flex-wrap items-center justify-center gap-4">
      <button type="button" v-on:click="save()" class="w-32 text-center rounded-md bg-gray-200 px-3 py-2 px-8 text-sm font-semibold text-gray-600 shadow-sm hover:bg-gray-300 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-100">Salvar</button>
      <a href="./regras.pdf" target="_blank" class="w-32 text-center rounded-md border border-gray-200 px-3 py-2 px-8 text-sm font-semibold text-gray-400 shadow-sm hover:bg-gray-300/30 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-100">Regras</a>
      <a href="./guia.pdf" target="_blank" class="w-32 text-center rounded-md border border-gray-200 px-3 py-2 px-8 text-sm font-semibold text-gray-400 shadow-sm hover:bg-gray-300/30 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-100">Guia</a>
      <a href="./map.jpg" target="_blank" class="w-32 text-center rounded-md border border-gray-200 px-3 py-2 px-8 text-sm font-semibold text-gray-400 shadow-sm hover:bg-gray-300/30 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-100">Mapa</a>
      <a href="./cidadela.pdf" target="_blank" class="w-32 text-center rounded-md border border-gray-200 px-3 py-2 px-8 text-sm font-semibold text-gray-400 shadow-sm hover:bg-gray-300/30 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-100">Cidadela</a>
      <a href="./regiao.pdf" target="_blank" class="w-32 text-center rounded-md border border-gray-200 px-3 py-2 px-8 text-sm font-semibold text-gray-400 shadow-sm hover:bg-gray-300/30 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-100">Região</a>
    </div>

    <!-- BEGIN:: MODALS -->
    <div
      class="relative z-10 hidden"
      v-bind:style="{ display: game.modal.is_open_abilities ? 'block':'none' }"
      aria-labelledby="modal-title"
      role="dialog"
      aria-modal="true"
      id="modal-abilities"
    >
      <div
        class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
        v-bind:style="{ display: game.modal.is_open_abilities ? 'block':'none' }"
      ></div>
      <div class="fixed inset-0 z-10 w-screen overflow-y-auto">
        <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
          <div class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl">
            <div class="bg-slate-800 px-4 pb-4 pt-5 sm:p-6 sm:pb-4">
              <!-- BEGIN:: HEADER -->
              <div>
                <div class="mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left">
                  <h3 class="text-base font-semibold leading-6 text-gray-50" id="modal-title">Habilidades</h3>
                  <p class="text-sm text-gray-500">Selecione as habilidades do seu personagem.</p>
                </div>
              </div>
              <!-- END:: HEADER -->
              <div class="pt-6 pr-2 max-h-[calc(100vh-13rem)] overflow-y-auto">
                <div class="grid grid-cols-2 gap-4">
                  <label class="flex hover:bg-slate-700 p-2 pt-1 rounded-md border border-slate-700" v-for="ability in game.abilities" :key="ability.name">
                    <input
                      type="checkbox"
                      v-on:change="updateAbility($event.target)"
                      v-bind:checked="atributos.habilidades && atributos.habilidades.includes(ability.name)"
                      v-bind:value="ability.name"
                      name="check_abilities"class="h-4 w-4 rounded border-gray-300 text-indigo-600  self-center focus:ring-indigo-500">
                    <div class="ml-3 min-w-0 flex-1 text-gray-400">
                      {{ ability.name }}<br/>
                      <span class="text-xs text-gray-500 leading-none block">
                        {{ ability.description }}
                      </span>
                    </div>
                  </label>
                </div>
              </div>
            </div>
            <div class="bg-gray-900 px-4 py-3 sm:flex sm:justify-end gap-2 sm:px-6">
              <button
                type="button"
                class="mt-3 inline-flex w-full justify-center rounded-md px-3 py-2 text-sm font-semibold text-gray-400 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50/10 sm:mt-0 sm:w-auto"
                v-on:click="closeModal('abilities')"
              >Fechar</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div
      class="relative z-10 hidden"
      v-bind:style="{ display: game.modal.is_open_equipaments ? 'block':'none' }"
      aria-labelledby="modal-title"
      role="dialog"
      aria-modal="true"
      id="modal-equipaments"
    >
      <div
        class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
        v-bind:style="{ display: game.modal.is_open_equipaments ? 'block':'none' }"
      ></div>
      <div class="fixed inset-0 z-10 w-screen overflow-y-auto">
        <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
          <div class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl">
            <div class="bg-slate-800 px-4 pb-4 pt-5 sm:p-6 sm:pb-4">
              <!-- BEGIN:: HEADER -->
              <div>
                <div class="mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left">
                  <h3 class="text-base font-semibold leading-6 text-gray-50" id="modal-title">Equipamentos</h3>
                  <p class="text-sm text-gray-500">Selecione os equipamentos do seu personagem.</p>
                </div>
              </div>
              <!-- END:: HEADER -->
              <div class="pt-6 pr-2 max-h-[calc(100vh-13rem)] overflow-y-auto">
                <div class="grid grid-cols-2 gap-4">
                  <label class="flex hover:bg-slate-700 p-2 pt-1 rounded-md border border-slate-700" v-for="equipament in game.equipaments" :key="equipament.name">
                    <input
                      type="checkbox"
                      v-on:change="updateEquipament($event.target)"
                      v-bind:checked="itens.equipamentos && itens.equipamentos.includes(equipament.name)"
                      v-bind:value="equipament.name"
                      name="check_equipaments"class="h-4 w-4 rounded border-gray-300 text-indigo-600  self-center focus:ring-indigo-500">
                    <div class="ml-3 min-w-0 flex-1 text-gray-400">
                      {{ equipament.name }}<br/>
                      <span class="text-xs text-gray-500 leading-none block">
                        <b>Custo:</b> {{ equipament.cost }}
                      </span>
                    </div>
                  </label>
                </div>
              </div>
            </div>
            <div class="bg-gray-900 px-4 py-3 sm:flex sm:justify-end gap-2 sm:px-6">
              <button
                type="button"
                class="mt-3 inline-flex w-full justify-center rounded-md px-3 py-2 text-sm font-semibold text-gray-400 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50/10 sm:mt-0 sm:w-auto"
                v-on:click="closeModal('equipaments')"
              >Fechar</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div
      class="relative z-10 hidden"
      v-bind:style="{ display: game.modal.is_open_arms ? 'block':'none' }"
      aria-labelledby="modal-title"
      role="dialog"
      aria-modal="true"
      id="modal-arms"
    >
      <div
        class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
        v-bind:style="{ display: game.modal.is_open_arms ? 'block':'none' }"
      ></div>
      <div class="fixed inset-0 z-10 w-screen overflow-y-auto">
        <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
          <div class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl">
            <div class="bg-slate-800 px-4 pb-4 pt-5 sm:p-6 sm:pb-4">
              <!-- BEGIN:: HEADER -->
              <div>
                <div class="mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left">
                  <h3 class="text-base font-semibold leading-6 text-gray-50" id="modal-title">Armas e Armaduras</h3>
                  <p class="text-sm text-gray-500">Selecione as armas e armaduras do seu personagem.</p>
                </div>
              </div>
              <!-- END:: HEADER -->
              <div class="pt-6 pr-2 max-h-[calc(100vh-13rem)] overflow-y-auto">
                <div class="grid grid-cols-2 gap-4">
                  <label class="flex hover:bg-slate-700 p-2 pt-1 rounded-md border border-slate-700" v-for="arm in game.arms" :key="arm.name">
                    <input
                      type="checkbox"
                      v-on:change="updateArm($event.target)"
                      v-bind:checked="itens.armas && itens.armas.some((a) => a.name === arm.name)"
                      v-bind:value="arm.name"
                      name="check_arms"class="h-4 w-4 rounded border-gray-300 text-indigo-600  self-center focus:ring-indigo-500">
                    <div class="ml-3 min-w-0 flex-1 text-gray-400">
                      {{ arm.name }}<br/>
                      <span class="text-xs text-gray-500 leading-none block">
                        {{ arm.description }}
                        <br/><br/>
                        <b>Custo:</b> {{ arm.cost }} | <b>Valor:</b> {{ arm.value }}
                      </span>
                    </div>
                  </label>
                </div>
              </div>
            </div>
            <div class="bg-gray-900 px-4 py-3 sm:flex sm:justify-end gap-2 sm:px-6">
              <button
                type="button"
                class="mt-3 inline-flex w-full justify-center rounded-md px-3 py-2 text-sm font-semibold text-gray-400 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50/10 sm:mt-0 sm:w-auto"
                v-on:click="closeModal('arms')"
              >Fechar</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- END:: MODALS -->
  </main>
  <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
  <script>
    //#region STORAGE
    const storageKey = 'rpg@player';
    let playerPayload = undefined;
    const setPlayer = (player) => {
      playerPayload = JSON.stringify(player)
      localStorage.setItem(storageKey, playerPayload)
    }
    const getPlayer = () => {
      const player = localStorage.getItem(storageKey)
      try{ return JSON.parse(player); }
      catch(e){ return undefined; }
    }
    const initialPlayer = getPlayer();
    //#endregion STORAGE'
    const availableModals = ['abilities', 'equipaments', 'arms'];
    const app = new Vue({
      el: '#app',
      data: {
        bio: {
          nome: initialPlayer?.bio?.nome ?? '',
          ocupacao: initialPlayer?.bio?.ocupacao ?? '',
          origem : initialPlayer?.bio?.origem ?? '',
        },
        atributos: {
          forca: initialPlayer?.atributos?.forca ?? 0,
          modificador_forca: initialPlayer?.atributos?.modificador_forca ?? 0,
          agilidade: initialPlayer?.atributos?.agilidade ?? 0,
          modificador_agilidade: initialPlayer?.atributos?.modificador_agilidade ?? 0,
          saude: initialPlayer?.atributos?.saude ?? 0,
          modificador_saude: initialPlayer?.atributos?.modificador_saude ?? 0,
          inteligencia: initialPlayer?.atributos?.inteligencia ?? 0,
          modificador_inteligencia: initialPlayer?.atributos?.modificador_inteligencia ?? 0,
          sabedoria: initialPlayer?.atributos?.sabedoria ?? 0,
          modificador_sabedoria: initialPlayer?.atributos?.modificador_sabedoria ?? 0,
          personalidade: initialPlayer?.atributos?.personalidade ?? 0,
          modificador_personalidade: initialPlayer?.atributos?.modificador_personalidade ?? 0,
          defesa: initialPlayer?.atributos?.defesa ?? '',
          vida: initialPlayer?.atributos?.vida ?? '',
          habilidades: initialPlayer?.atributos?.habilidades ?? []
        },
        itens: {
          equipamentos: initialPlayer?.itens?.equipamentos ?? [],
          armas: initialPlayer?.itens?.armas ?? [],
          tesouros: initialPlayer?.itens?.tesouros && initialPlayer.itens.tesouros.length > 0 ? initialPlayer.itens.tesouros : ['']
        },
        game: {
          is_auto_saved: false,
          modal: {
            is_open_abilities: false,
            is_open_equipaments: false,
            is_open_arms: false,
          },
          abilities: [
            { name: '11. Arremesso',    description: 'Arremesso: adicione +1 à rolagem de Ataque toda vez que tentar acertar um oponente com alguma arma do tipo Arremesso (veja pág. 53).' },
            { name: '12. Ataque Duplo', description: 'Ataque Duplo: faça a rolagem de Ataque duas vezes.' },
            { name: '13. Caça',         description: 'Caça: você pode construir armadilhas simples e preparar a caça para alimento.' },
            { name: '14. Combate',      description: 'Combate: adicione +1 à rolagem de Ataque toda vez que tentar acertar um oponente com alguma arma do tipo Combate (veja pág. 53).' },
            { name: '15. Conhecimento', description: 'Conhecimento: você é capaz de compreender assuntos específicos  com profundidade considerável.' },
            { name: '16. Construção',   description: 'Construção: você sabe como planejar e executar projetos de habitações, fortificações ou excavações.' },
            { name: '21. Cura',         description: 'Cura: adicione +1 à rolagem de Teste de Atributo toda vez que tentar curar ferimentos. Caso obtenha sucesso, a vítima recupera até 1d3+3 Pontos de Vida.' },
            { name: '22. Diplomacia',   description: 'Diplomacia: você sabe como conduzir  situações delicadas com sensatez.' },
            { name: '23. Erudição',     description: 'Erudição: você é capaz de ler e escrever textos simples.' },
            { name: '24. Escalada',     description: 'Escalada: você pode subir superfícies íngremes.' },
            { name: '25. Exploração',   description: 'Exploração: adicione +1 à rolagem de Teste de Atributo toda vez que  tentar encontrar algo nos ermos.' },
            { name: '26. Feitiçaria',   description: 'Feitiçaria: adicione +1 à rolagem de Teste de Atributo toda vez que  tentar conjurar um feitiço.' },
            { name: '31. Furtividade',  description: 'Furtividade: adicione +1 à rolagem de Teste de Atributo toda vez que  tentar se esconder ou mover-se  silenciosamente.' },
            { name: '32. Herbalismo',   description: 'Herbalismo: você sabe onde buscar  ervas e preparar antídotos e remédios.' },
            { name: '33. Idioma',       description: 'Idioma: você conhece outras línguas e  pode se comunicar em outros idiomas.' },
            { name: '34. Intimidação',  description: 'Intimidação: adicione +1 à rolagem de Teste de Atributo toda vez que  tentar amedrontar ou subjugar alguém.' },
            { name: '35. Lábia',        description: 'Lábia: adicione +1 à rolagem de Teste de Atributo toda vez que  tentar enganar outras pessoas.' },
            { name: '36. Ladinagem',    description: 'Ladinagem: adicione +1 à rolagem de Teste de Atributo toda vez que  tentar abrir fechaduras, desarmar  armadilhas ou furtar alguém.' },
            { name: '41. Lei',          description: 'Lei: você conhece códigos penais.' },
            { name: '42. Liderança',    description: 'Liderança: adicione +1 à rolagem de Teste de Atributo toda vez que  tentar comandar outras pessoas.' },
            { name: '43. Luta',         description: 'Luta: adicione +1 à rolagem de Ataque toda vez que tentar acertar um oponente com alguma  arma do tipo Luta (veja pág. 53).' },
            { name: '44. Manha',        description: 'Manha: você pode resolver embaraços  através de subterfúgios ou contatos.' },
            { name: '45. Montaria',     description: 'Montaria: você sabe conduzir animais.' },
            { name: '46. Navegação',    description: 'Navegação: você conduz embarcações.' },
            { name: '51. Negociação',   description: 'Negociação: adicione +1 à rolagem de Teste de Atributo toda vez que tentar barganhar.' },
            { name: '52. Observação',   description: 'Observação: você pode notar detalhes.' },
            { name: '53. Ocultismo',    description: 'Ocultismo: você pode compreender  assuntos obscuros de natureza mística.' },
            { name: '54. Ofício',       description: 'Ofício: você é capaz de executar um  trabalho específico ou especializado.' },
            { name: '55. Persuasão',    description: 'Persuasão: adicione +1 à rolagem de Teste de Atributo toda vez que  tentar convencer outras pessoas.' },
            { name: '56. Pontaria',     description: 'Pontaria: adicione +1 à rolagem de Ataque toda vez que tentar acertar um oponente com alguma  arma do tipo Pontaria (veja pág. 53).' },
            { name: '61. Prontidão',    description: 'Prontidão: você age primeiro no Ataque e raramente é surpreendido.' },
            { name: '62. Rastreio',     description: 'Rastreio: adicione +1 à rolagem de Teste de Atributo toda vez que  tentar encontrar rastros.' },
            { name: '63. Religião',     description: 'Religião: você conhece ritos e crenças de natureza divina.' },
            { name: '64. Resistência',  description: 'Resistência: adicione +1 à rolagem de Teste de Atributo toda vez que  tentar resistir à um esforço fora do  comum ou estiver sob ação de algum  tipo de veneno ou substância tóxica.' },
            { name: '65. Sobrevivência',description: 'Sobrevivência: adicione +1 à rolagem de Teste de Atributo toda vez que  tentar encontrar abrigo nos ermos.' },
            { name: '66. Tradição',     description: 'Tradição: você conhece costumes, lendas e profecias de um povo' },
          ],
          arms: [
            { name: "Adaga",             value: '1d6', description: "Arremesso e Luta Cortante e Perfurante", cost: 5 },
            { name: "Arco Curto",        value: '2d6', description: "Pontaria Perfurante (Flecha)", cost: 15 },
            { name: "Arco Longo",        value: '3d6', description: "Pontaria Perfurante (Flecha)", cost: 25 },
            { name: "Arma de Haste",     value: '3d6', description: "Combate Perfurante", cost: 20 },
            { name: "Bastão",            value: '1d6', description: "Luta Contundente", cost: 2 },
            { name: "Besta",             value: '3d6', description: "Pontaria Perfurante (Virote)", cost: 30 },
            { name: "Cajado",            value: '1d6', description: "Luta Contundente", cost: 2 },
            { name: "Chicote",           value: '1d6', description: "Luta Contundente e Cortante", cost: 5 },
            { name: "Clava",             value: '1d6', description: "Luta Contundente", cost: 2 },
            { name: "Clava Grande",      value: '2d6', description: "Luta Contundente", cost: 10 },
            { name: "Clava Gigante",     value: '3d6', description: "Luta Contundente", cost: 20 },
            { name: "Dardo",             value: '1d6', description: "Arremesso e Luta Perfurante", cost: 5 },
            { name: "Espada Curta",      value: '2d6', description: "Combate Cortante e Perfurante", cost: 15 },
            { name: "Espada Longa",      value: '3d6', description: "Combate Cortante e Perfurante", cost: 20 },
            { name: "Faca",              value: '1d6', description: "Arremesso e Luta Cortante e Perfurante", cost: 5 },
            { name: "Funda",             value: '1d6', description: "Pontaria Contundente (Pedra)", cost: 2 },
            { name: "Lança",             value: '2d6', description: "Combate Perfurante", cost: 15 },
            { name: "Lança de Montaria", value: '3d6', description: "Combate Perfurante", cost: 20 },
            { name: "Maça",              value: '1d6', description: "Combate Contundente", cost: 5 },
            { name: "Machado",           value: '2d6', description: "Arremesso e Luta Contundente e Cortante", cost: 10 },
            { name: "Machado de Batalha",value: '3d6', description: "Combate Contundente e Cortante", cost: 20 },
            { name: "Martelo",           value: '1d6', description: "Arremesso e Luta Contundente", cost: 5 },
            { name: "Martelode Guerra",  value: '2d6', description: "Combate Contundente", cost: 15 },
            { name: "Porrete",           value: '1d6', description: "Luta Contundente", cost: 2 },
            { name: "Porrete com Pontas",value: '2d6', description: "Luta Contundente e Perfurante", cost: 10 },
            { name: "Punhal",            value: '1d6', description: "Arremesso e Luta Cortante e Perfurante", cost: 5 },
            { name: "Cota de Malha",     value: '+2',  description: "Reduz Dano Cortante e Perfurante em até 1d3+3 por até 1d3+3 vezes*", cost: 150 },
            { name: "Couraça",           value: '+1',  description: "Reduz Dano Cortante em até 1d6 por até 1d3+3 vezes*", cost: 50 },
            { name: "Escudo Grande",     value: '+1',  description: "Reduz Dano Contundente, Cortante e Perfurante em até 1d6 por até 1d3+3 vezes", cost: 60 },
            { name: "Escudo Pequeno",    value: '+1',  description: "Reduz Dano Contundente, Cortante e Perfurante em até 1d3 por até 1d2+2 vezes", cost: 30 },
            { name: "Peles",             value: '+1',  description: "Reduz Dano Cortante em até 1d3 por até 1d2+2 vezes*", cost: 25 },
          ],
          equipaments: [
            { name: "Antídoto (para tratar venenos)", cost: 30 },
            { name: "Bandagem (3 unidades)",          cost: 2 },
            { name: "Bolsa",                          cost: 2 },
            { name: "Botas de Viagem",                cost: 5 },
            { name: "Cadeado",                        cost: 15 },
            { name: "Capa",                           cost: 10 },
            { name: "Cesta",                          cost: 1 },
            { name: "Cinto",                          cost: 2 },
            { name: "Cinzel (para esculpir pedra)",   cost: 2 },
            { name: "Comida (3 porções)",             cost: 1 },
            { name: "Corda (3 metros)",               cost: 1 },
            { name: "Corrente (1 metro)",             cost: 5 },
            { name: "Elixir (para tratar doenças)",   cost: 30 },
            { name: "Ervas",                          cost: 5 },
            { name: "Espelho de Metal",               cost: 10 },
            { name: "Flauta",                         cost: 5 },
            { name: "Flechas ou Virotes (6 unidades)",cost: 1 },
            { name: "Formão (para entalhar madeira)", cost: 2 },
            { name: "Gancho",                         cost: 5 },
            { name: "Gazuas (3 unidades)",            cost: 15 },
            { name: "Harpa",                          cost: 20 },
            { name: "Lamparina de Cerâmica",          cost: 2 },
            { name: "Lanterna de Bronze",             cost: 10 },
            { name: "Machadinha",                     cost: 2 },
            { name: "Martelete",                      cost: 2 },
            { name: "Montaria",                       cost: 100 },
            { name: "Odre",                           cost: 2 },
            { name: "Óleo (frasco)",                  cost: 5 },
            { name: "Pederneira",                     cost: 5 },
            { name: "Pedra de Amolar",                cost: 2 },
            { name: "Pergaminho (em branco)",         cost: 30 },
            { name: "Saco",                           cost: 1 },
            { name: "Símbolo Sagrado",                cost: 20 },
            { name: "Tocha (3 unidades)",             cost: 1 },
            { name: "Vela",                           cost: 2 },
            { name: "Veneno (frasco)",                cost: 10 },
          ]
        }
      },
      mounted() {
        const recursiveAutosave = () => {
          console.log('[verify-auto-save]');
          if(this.verifyPayloadAndSave()){
            this.game.is_auto_saved = true;

            setTimeout(() => this.game.is_auto_saved = false, 3 * 1000);
          }

          setTimeout(recursiveAutosave, 4 * 1000)
        }
        setTimeout(recursiveAutosave, 4 * 1000)
      },
      methods: {
        openModal: function (modal){
          if(!availableModals.includes(modal)){
            console.error(`[invalid-modal-to-open:${modal}]`)
            return;
          }

          this.game.modal[`is_open_${modal}`] = true;
        },
        closeModal: function (modal){
          if(!availableModals.includes(modal)){
            console.error(`[invalid-modal-to-close:${modal}]`)
            return;
          }

          this.game.modal[`is_open_${modal}`] = false;
        },
        save: function (){
          const player = {
            bio: this.bio,
            atributos: this.atributos,
            itens: this.itens
          }

          setPlayer(player)
        },
        verifyPayloadAndSave: function(){
          const storagedPlayer = getPlayer();

          const player = { bio: this.bio, atributos: this.atributos, itens: this.itens };

          if(JSON.stringify(storagedPlayer) === JSON.stringify(player)) return false;

          this.save();

          return true;
        },
        updateAbility: function (el){
          const isChecked = el.checked;
          const value = el.value;

          if(!this.atributos.habilidades) this.atributos.habilidades = [];
          
          if(isChecked){
            if(!this.atributos.habilidades.includes(value)) this.atributos.habilidades.push(
              value
            )
          }
          else this.atributos.habilidades = this.atributos.habilidades.filter(
            (ab) => ab !== value
          )
        },
        updateEquipament: function (el){
          const isChecked = el.checked;
          const value = el.value;

          if(!this.itens.equipamentos) this.itens.equipamentos = [];
          
          if(isChecked){
            if(!this.itens.equipamentos.includes(value)) this.itens.equipamentos.push(
              value
            );
          }
          else this.itens.equipamentos = this.itens.equipamentos.filter(
            (ab) => ab !== value
          );
        },
        updateArm: function (el){
          const isChecked = el.checked;
          const value = el.value;

          if(!this.itens.armas) this.itens.armas = [];
          
          const finded = this.game.arms.find((arm) => arm.name === value);
          if(!finded) return;
          
          if(isChecked){
            if(!this.itens.armas.some((arm) => arm.name === name)) this.itens.armas.push({
              name: value,
              value: finded.value
            });
          }
          else this.itens.armas = this.itens.armas.filter(
            (arm) => arm.name !== value
          )
        }
      }
    });

    window.onload
  </script>
</body>
</html>